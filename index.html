<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Theo D√µi T·∫≠p T√≠nh 12 Con D√™</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        * {
            font-family: 'Nunito', sans-serif;
        }
        body {
            background-image: url('https://images.unsplash.com/photo-1524024973431-2ad916746881?w=1920&q=80');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            min-height: 100vh;
        }
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: -1;
        }
        .goat-card {
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.9);
            transition: all 0.3s ease;
        }
        .goat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
        }
        .behavior-btn {
            transition: all 0.2s ease;
        }
        .behavior-btn:hover {
            transform: scale(1.1);
        }
        .behavior-btn.active {
            ring: 4px;
            ring-color: #10b981;
        }
        .header-bg {
            backdrop-filter: blur(15px);
            background: rgba(255, 255, 255, 0.85);
        }
        .stats-card {
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.9);
        }
        @keyframes bounce-slow {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        .goat-emoji {
            animation: bounce-slow 2s infinite;
        }
    </style>
</head>
<body class="min-h-screen p-4 md:p-6">
    <!-- Header -->
    <header class="header-bg rounded-2xl shadow-xl p-6 mb-6 max-w-7xl mx-auto">
        <div class="flex flex-col md:flex-row items-center justify-between gap-4">
            <div class="flex items-center gap-4">
                <span class="text-5xl goat-emoji">üêê</span>
                <div>
                    <h1 class="text-2xl md:text-3xl font-extrabold text-gray-800">Theo D√µi T·∫≠p T√≠nh ƒê√†n D√™</h1>
                    <p class="text-gray-600">Qu·∫£n l√Ω 12 con d√™ nu√¥i nh·ªët h√†ng ng√†y</p>
                </div>
            </div>
            <div class="flex items-center gap-4">
                <div class="text-center">
                    <input type="date" id="currentDate" class="px-4 py-2 rounded-lg border-2 border-green-300 focus:border-green-500 focus:outline-none font-semibold">
                </div>
                <button onclick="exportData()" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-semibold transition flex items-center gap-2">
                    üìä Xu·∫•t b√°o c√°o
                </button>
            </div>
        </div>
    </header>

    <!-- Stats Overview -->
    <div class="max-w-7xl mx-auto mb-6 grid grid-cols-2 md:grid-cols-4 gap-4">
        <div class="stats-card rounded-xl p-4 text-center shadow-lg">
            <div class="text-3xl mb-2">üçΩÔ∏è</div>
            <div class="text-2xl font-bold text-green-600" id="eatingCount">0</div>
            <div class="text-gray-600 text-sm">ƒêang ƒÉn</div>
        </div>
        <div class="stats-card rounded-xl p-4 text-center shadow-lg">
            <div class="text-3xl mb-2">üò¥</div>
            <div class="text-2xl font-bold text-blue-600" id="sleepingCount">0</div>
            <div class="text-gray-600 text-sm">ƒêang ng·ªß</div>
        </div>
        <div class="stats-card rounded-xl p-4 text-center shadow-lg">
            <div class="text-3xl mb-2">üèÉ</div>
            <div class="text-2xl font-bold text-orange-600" id="playingCount">0</div>
            <div class="text-gray-600 text-sm">ƒêang ch∆°i</div>
        </div>
        <div class="stats-card rounded-xl p-4 text-center shadow-lg">
            <div class="text-3xl mb-2">üíö</div>
            <div class="text-2xl font-bold text-emerald-600" id="healthyCount">12</div>
            <div class="text-gray-600 text-sm">Kh·ªèe m·∫°nh</div>
        </div>
    </div>

    <!-- Goat Grid -->
    <div class="max-w-7xl mx-auto grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-5" id="goatGrid">
        <!-- Goat cards will be generated here -->
    </div>

    <!-- Note Modal -->
    <div id="noteModal" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden items-center justify-center z-50">
        <div class="bg-white rounded-2xl p-6 max-w-md w-full mx-4 shadow-2xl">
            <h3 class="text-xl font-bold mb-4 flex items-center gap-2">
                <span class="text-2xl">üìù</span> Ghi ch√∫ cho <span id="modalGoatName"></span>
            </h3>
            <textarea id="noteText" rows="4" class="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-green-500 focus:outline-none" placeholder="Nh·∫≠p ghi ch√∫ v·ªÅ t·∫≠p t√≠nh, s·ª©c kh·ªèe..."></textarea>
            <div class="flex gap-3 mt-4">
                <button onclick="saveNote()" class="flex-1 bg-green-600 hover:bg-green-700 text-white py-2 rounded-xl font-semibold transition">L∆∞u</button>
                <button onclick="closeNoteModal()" class="flex-1 bg-gray-200 hover:bg-gray-300 text-gray-700 py-2 rounded-xl font-semibold transition">H·ªßy</button>
            </div>
        </div>
    </div>

    <script>
        // Goat data
        const goats = [
            { id: 1, name: "B√¥ng", age: "2 tu·ªïi", gender: "C√°i", color: "Tr·∫Øng" },
            { id: 2, name: "ƒêen", age: "3 tu·ªïi", gender: "ƒê·ª±c", color: "ƒêen" },
            { id: 3, name: "N√¢u", age: "1.5 tu·ªïi", gender: "C√°i", color: "N√¢u" },
            { id: 4, name: "ƒê·ªëm", age: "2 tu·ªïi", gender: "ƒê·ª±c", color: "ƒê·ªëm" },
            { id: 5, name: "M·∫≠p", age: "4 tu·ªïi", gender: "C√°i", color: "Tr·∫Øng" },
            { id: 6, name: "Nh·ªè", age: "8 th√°ng", gender: "C√°i", color: "X√°m" },
            { id: 7, name: "S·ª´ng D√†i", age: "3 tu·ªïi", gender: "ƒê·ª±c", color: "N√¢u" },
            { id: 8, name: "B√© Bi", age: "6 th√°ng", gender: "ƒê·ª±c", color: "Tr·∫Øng" },
            { id: 9, name: "L√¥ng X√π", age: "2.5 tu·ªïi", gender: "C√°i", color: "X√°m" },
            { id: 10, name: "V√†ng", age: "1 tu·ªïi", gender: "C√°i", color: "V√†ng n√¢u" },
            { id: 11, name: "ƒê·∫ßu ƒê√†n", age: "5 tu·ªïi", gender: "ƒê·ª±c", color: "ƒêen tr·∫Øng" },
            { id: 12, name: "√öt", age: "4 th√°ng", gender: "C√°i", color: "Tr·∫Øng" }
        ];

        const behaviors = [
            { id: 'eating', emoji: 'üçΩÔ∏è', label: 'ƒÇn', color: 'bg-green-100 hover:bg-green-200 text-green-700' },
            { id: 'drinking', emoji: 'üíß', label: 'U·ªëng', color: 'bg-blue-100 hover:bg-blue-200 text-blue-700' },
            { id: 'sleeping', emoji: 'üò¥', label: 'Ng·ªß', color: 'bg-purple-100 hover:bg-purple-200 text-purple-700' },
            { id: 'playing', emoji: 'üèÉ', label: 'Ch∆°i', color: 'bg-orange-100 hover:bg-orange-200 text-orange-700' },
            { id: 'resting', emoji: 'üßò', label: 'Ngh·ªâ', color: 'bg-teal-100 hover:bg-teal-200 text-teal-700' },
            { id: 'sick', emoji: 'ü§í', label: '·ªêm', color: 'bg-red-100 hover:bg-red-200 text-red-700' }
        ];

        let goatRecords = {};
        let currentNoteGoatId = null;

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('currentDate').value = today;
            loadData();
            renderGoatCards();
            updateStats();
        });

        document.getElementById('currentDate').addEventListener('change', () => {
            loadData();
            renderGoatCards();
            updateStats();
        });

        function getDateKey() {
            return document.getElementById('currentDate').value;
        }

        function loadData() {
            const saved = localStorage.getItem('goatRecords');
            if (saved) {
                goatRecords = JSON.parse(saved);
            }
            const dateKey = getDateKey();
            if (!goatRecords[dateKey]) {
                goatRecords[dateKey] = {};
                goats.forEach(g => {
                    goatRecords[dateKey][g.id] = {
                        behaviors: [],
                        note: '',
                        times: {}
                    };
                });
            }
        }

        function saveData() {
            localStorage.setItem('goatRecords', JSON.stringify(goatRecords));
        }

        function renderGoatCards() {
            const grid = document.getElementById('goatGrid');
            const dateKey = getDateKey();
            grid.innerHTML = goats.map(goat => {
                const record = goatRecords[dateKey]?.[goat.id] || { behaviors: [], note: '', times: {} };
                const goatEmojis = ['üêê', 'üêë'];
                const emoji = goat.gender === 'ƒê·ª±c' ? 'üêê' : 'üêë';
                
                return `
                    <div class="goat-card rounded-2xl p-5 shadow-xl">
                        <div class="flex items-center justify-between mb-4">
                            <div class="flex items-center gap-3">
                                <span class="text-4xl">${emoji}</span>
                                <div>
                                    <h3 class="font-bold text-lg text-gray-800">${goat.name}</h3>
                                    <p class="text-sm text-gray-500">${goat.age} ‚Ä¢ ${goat.gender} ‚Ä¢ ${goat.color}</p>
                                </div>
                            </div>
                            <span class="text-xs font-semibold px-2 py-1 rounded-full ${record.behaviors.includes('sick') ? 'bg-red-100 text-red-600' : 'bg-green-100 text-green-600'}">
                                ${record.behaviors.includes('sick') ? 'C·∫ßn theo d√µi' : 'B√¨nh th∆∞·ªùng'}
                            </span>
                        </div>
                        
                        <div class="grid grid-cols-3 gap-2 mb-4">
                            ${behaviors.map(b => `
                                <button 
                                    onclick="toggleBehavior(${goat.id}, '${b.id}')"
                                    class="behavior-btn ${b.color} ${record.behaviors.includes(b.id) ? 'ring-2 ring-offset-1 ring-green-500' : ''} p-2 rounded-xl text-center"
                                >
                                    <div class="text-xl">${b.emoji}</div>
                                    <div class="text-xs font-semibold">${b.label}</div>
                                    ${record.times[b.id] ? `<div class="text-xs opacity-70">${record.times[b.id]}</div>` : ''}
                                </button>
                            `).join('')}
                        </div>
                        
                        <div class="flex gap-2">
                            <button 
                                onclick="openNoteModal(${goat.id}, '${goat.name}')"
                                class="flex-1 bg-gray-100 hover:bg-gray-200 text-gray-700 py-2 px-3 rounded-xl text-sm font-semibold transition flex items-center justify-center gap-1"
                            >
                                üìù ${record.note ? 'Xem ghi ch√∫' : 'Th√™m ghi ch√∫'}
                            </button>
                        </div>
                        
                        ${record.note ? `
                            <div class="mt-3 p-2 bg-yellow-50 rounded-lg text-sm text-gray-600 border border-yellow-200">
                                <strong>Ghi ch√∫:</strong> ${record.note}
                            </div>
                        ` : ''}
                    </div>
                `;
            }).join('');
        }

        function toggleBehavior(goatId, behaviorId) {
            const dateKey = getDateKey();
            const record = goatRecords[dateKey][goatId];
            const index = record.behaviors.indexOf(behaviorId);
            
            if (index > -1) {
                record.behaviors.splice(index, 1);
                delete record.times[behaviorId];
            } else {
                record.behaviors.push(behaviorId);
                record.times[behaviorId] = new Date().toLocaleTimeString('vi-VN', { hour: '2-digit', minute: '2-digit' });
            }
            
            saveData();
            renderGoatCards();
            updateStats();
        }

        function openNoteModal(goatId, goatName) {
            currentNoteGoatId = goatId;
            document.getElementById('modalGoatName').textContent = goatName;
            const dateKey = getDateKey();
            document.getElementById('noteText').value = goatRecords[dateKey][goatId]?.note || '';
            document.getElementById('noteModal').classList.remove('hidden');
            document.getElementById('noteModal').classList.add('flex');
        }

        function closeNoteModal() {
            document.getElementById('noteModal').classList.add('hidden');
            document.getElementById('noteModal').classList.remove('flex');
            currentNoteGoatId = null;
        }

        function saveNote() {
            const dateKey = getDateKey();
            goatRecords[dateKey][currentNoteGoatId].note = document.getElementById('noteText').value;
            saveData();
            renderGoatCards();
            closeNoteModal();
        }

        function updateStats() {
            const dateKey = getDateKey();
            const records = goatRecords[dateKey];
            
            let eating = 0, sleeping = 0, playing = 0, healthy = 12;
            
            Object.values(records).forEach(record => {
                if (record.behaviors.includes('eating')) eating++;
                if (record.behaviors.includes('sleeping')) sleeping++;
                if (record.behaviors.includes('playing')) playing++;
                if (record.behaviors.includes('sick')) healthy--;
            });
            
            document.getElementById('eatingCount').textContent = eating;
            document.getElementById('sleepingCount').textContent = sleeping;
            document.getElementById('playingCount').textContent = playing;
            document.getElementById('healthyCount').textContent = healthy;
        }

        function exportData() {
            const dateKey = getDateKey();
            const records = goatRecords[dateKey];
            
            let report = `B√ÅO C√ÅO T·∫¨P T√çNH ƒê√ÄN D√ä - NG√ÄY ${dateKey}\n`;
            report += '='.repeat(50) + '\n\n';
            
            goats.forEach(goat => {
                const record = records[goat.id];
                report += `üêê ${goat.name} (${goat.age}, ${goat.gender})\n`;
                report += `   M√†u: ${goat.color}\n`;
                report += `   T·∫≠p t√≠nh: ${record.behaviors.map(b => {
                    const behavior = behaviors.find(bh => bh.id === b);
                    return `${behavior.emoji} ${behavior.label} (${record.times[b] || ''})`;
                }).join(', ') || 'Ch∆∞a ghi nh·∫≠n'}\n`;
                if (record.note) {
                    report += `   Ghi ch√∫: ${record.note}\n`;
                }
                report += '\n';
            });
            
            // Download as text file
            const blob = new Blob([report], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `bao-cao-de-${dateKey}.txt`;
            a.click();
            URL.revokeObjectURL(url);
        }

        // Close modal on outside click
        document.getElementById('noteModal').addEventListener('click', (e) => {
            if (e.target.id === 'noteModal') {
                closeNoteModal();
            }
        });
    </script>
</body>
</html>
