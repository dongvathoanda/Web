<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>B·∫£ng theo d√µi t·∫≠p t√≠nh s∆∞ t·ª≠ nu√¥i nh·ªët</title>
  <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
  <style>
    body {
      min-height: 100vh;
      background-image: url('https://images.unsplash.com/photo-1508672019048-805c876b67e2?auto=format&fit=crop&w=1600&q=80');
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
    }

    /* Custom scrollbar for notes list */
    .thin-scrollbar::-webkit-scrollbar {
      width: 6px;
    }
    .thin-scrollbar::-webkit-scrollbar-track {
      background: transparent;
    }
    .thin-scrollbar::-webkit-scrollbar-thumb {
      background-color: rgba(148, 163, 184, 0.7);
      border-radius: 9999px;
    }
  </style>
</head>
<body class="font-sans text-slate-100">
  <div class="min-h-screen bg-black/70 backdrop-blur-sm">
    <header class="border-b border-white/10 bg-gradient-to-r from-black/60 via-black/30 to-black/60">
      <div class="max-w-6xl mx-auto px-4 py-5 flex flex-col md:flex-row md:items-center md:justify-between gap-4">
        <div>
          <h1 class="text-2xl md:text-3xl font-bold tracking-tight flex items-center gap-3">
            <span class="inline-flex h-9 w-9 items-center justify-center rounded-full bg-amber-500/80 text-black font-extrabold shadow-lg shadow-amber-500/40">ü¶Å</span>
            <span>B·∫£ng theo d√µi t·∫≠p t√≠nh s∆∞ t·ª≠ nu√¥i nh·ªët</span>
          </h1>
          <p class="mt-2 text-sm md:text-base text-slate-200 max-w-2xl">
            D√πng ƒë·ªÉ ghi nh·∫≠n h√†nh vi h·∫±ng ng√†y c·ªßa s∆∞ t·ª≠ t·∫°i v∆∞·ªùn th√∫, nh·∫±m ph√°t hi·ªán s·ªõm d·∫•u hi·ªáu stress, bu·ªìn ch√°n
            ho·∫∑c b·∫•t th∆∞·ªùng v·ªÅ s·ª©c kh·ªèe.
          </p>
        </div>
        <div class="text-right space-y-1 text-xs md:text-sm">
          <p class="font-medium text-amber-300">Ch·∫ø ƒë·ªô: Quan s√°t ƒë·ªãnh k·ª≥</p>
          <p id="currentDate" class="text-slate-200">Ng√†y: --/--/----</p>
          <p id="currentTime" class="text-slate-300">Gi·ªù: --:--</p>
        </div>
      </div>
    </header>

    <main class="max-w-6xl mx-auto px-4 pb-10 pt-6 grid lg:grid-cols-3 gap-5">
      <!-- C·ªôt tr√°i: Th√¥ng tin c√° th·ªÉ + Ch·ªâ ti√™u ch√≠nh -->
      <section class="lg:col-span-2 space-y-5">
        <!-- Th√¥ng tin c√° th·ªÉ -->
        <div class="bg-black/60 border border-white/10 rounded-2xl p-4 md:p-5 shadow-xl shadow-black/40">
          <div class="flex items-center justify-between mb-4">
            <h2 class="text-lg md:text-xl font-semibold flex items-center gap-2">
              <span class="h-6 w-1.5 rounded-full bg-amber-500"></span>
              Th√¥ng tin c√° th·ªÉ
            </h2>
            <button id="clearAllBtn" class="text-xs px-2 py-1 rounded-full border border-red-400/60 text-red-200 hover:bg-red-500/10 active:scale-95 transition text-[11px]">
              Xo√° to√†n b·ªô d·ªØ li·ªáu
            </button>
          </div>
          <div class="grid md:grid-cols-3 gap-3 text-xs md:text-sm">
            <div class="space-y-1">
              <label class="block text-slate-200">T√™n/ID c√° th·ªÉ</label>
              <input id="lionId" type="text" class="w-full rounded-lg bg-black/60 border border-white/15 px-3 py-1.5 focus:outline-none focus:ring-1 focus:ring-amber-400/80" placeholder="VD: L01 - ƒê·ª±c tr∆∞·ªüng th√†nh" />
            </div>
            <div class="space-y-1">
              <label class="block text-slate-200">Gi·ªõi t√≠nh</label>
              <select id="lionSex" class="w-full rounded-lg bg-black/60 border border-white/15 px-3 py-1.5 focus:outline-none focus:ring-1 focus:ring-amber-400/80">
                <option value="">Ch·ªçn</option>
                <option value="ƒê·ª±c">ƒê·ª±c</option>
                <option value="C√°i">C√°i</option>
              </select>
            </div>
            <div class="space-y-1">
              <label class="block text-slate-200">Tu·ªïi ∆∞·ªõc t√≠nh (nƒÉm)</label>
              <input id="lionAge" type="number" min="0" step="0.1" class="w-full rounded-lg bg-black/60 border border-white/15 px-3 py-1.5 focus:outline-none focus:ring-1 focus:ring-amber-400/80" />
            </div>
            <div class="space-y-1">
              <label class="block text-slate-200">Khu chu·ªìng</label>
              <input id="enclosure" type="text" class="w-full rounded-lg bg-black/60 border border-white/15 px-3 py-1.5 focus:outline-none focus:ring-1 focus:ring-amber-400/80" placeholder="VD: Khu sƒÉn m·ªìi 1" />
            </div>
            <div class="space-y-1">
              <label class="block text-slate-200">Ng∆∞·ªùi ph·ª• tr√°ch quan s√°t</label>
              <input id="observer" type="text" class="w-full rounded-lg bg-black/60 border border-white/15 px-3 py-1.5 focus:outline-none focus:ring-1 focus:ring-amber-400/80" />
            </div>
            <div class="space-y-1">
              <label class="block text-slate-200">Khung gi·ªù quan s√°t ch√≠nh</label>
              <input id="timeSlot" type="text" class="w-full rounded-lg bg-black/60 border border-white/15 px-3 py-1.5 focus:outline-none focus:ring-1 focus:ring-amber-400/80" placeholder="VD: 08:00 ‚Äì 10:00" />
            </div>
          </div>
        </div>

        <!-- Ch·ªâ ti√™u ch√≠nh v·ªÅ t·∫≠p t√≠nh -->
        <div class="bg-black/60 border border-white/10 rounded-2xl p-4 md:p-5 shadow-xl shadow-black/40">
          <div class="flex items-center justify-between mb-4">
            <h2 class="text-lg md:text-xl font-semibold flex items-center gap-2">
              <span class="h-6 w-1.5 rounded-full bg-amber-500"></span>
              Ch·ªâ ti√™u h√†nh vi ch√≠nh (ƒëi·ªÉm 1‚Äì5)
            </h2>
            <p class="text-[11px] md:text-xs text-slate-300">
              1 = r·∫•t k√©m / b·∫•t th∆∞·ªùng, 3 = trung b√¨nh, 5 = t·ªët / b√¨nh th∆∞·ªùng
            </p>
          </div>
          <div class="overflow-x-auto text-xs md:text-sm">
            <table class="w-full border-separate border-spacing-y-1">
              <thead>
                <tr class="text-left text-slate-300 text-[11px] md:text-xs">
                  <th class="py-1.5 px-2">Ch·ªâ ti√™u</th>
                  <th class="py-1.5 px-2">√ù nghƒ©a</th>
                  <th class="py-1.5 px-2 w-36">ƒêi·ªÉm (1‚Äì5)</th>
                  <th class="py-1.5 px-2 w-40">Ghi ch√∫ nhanh</th>
                </tr>
              </thead>
              <tbody id="scoreTableBody" class="align-top">
                <tr class="bg-white/5 hover:bg-white/10 transition">
                  <td class="py-2 px-2 font-medium text-slate-100">ƒÇn u·ªëng</td>
                  <td class="py-2 px-2 text-slate-200">
                    L∆∞·ª£ng ƒÉn, t·ªëc ƒë·ªô ƒÉn, s·ª± h√†o h·ª©ng v·ªõi th·ª©c ƒÉn; gi·∫£m ƒÉn c√≥ th·ªÉ g·ª£i √Ω ƒëau, stress ho·∫∑c b·ªánh.
                  </td>
                  <td class="py-2 px-2">
                    <input type="range" min="1" max="5" value="3" data-key="feeding" class="score-slider w-full" />
                    <div class="text-[11px] mt-1 text-amber-200" data-label-for="feeding">Trung b√¨nh</div>
                  </td>
                  <td class="py-2 px-2">
                    <input type="text" data-note-for="feeding" class="w-full rounded-md bg-black/60 border border-white/15 px-2 py-1 text-[11px]" placeholder="VD: ƒÇn h·∫øt kh·∫©u ph·∫ßn trong 10 ph√∫t" />
                  </td>
                </tr>
                <tr class="bg-white/5 hover:bg-white/10 transition">
                  <td class="py-2 px-2 font-medium text-slate-100">M·ª©c ho·∫°t ƒë·ªông</td>
                  <td class="py-2 px-2 text-slate-200">
                    T·ªïng th·ªÉ t√≠ch ƒëi l·∫°i, leo tr√®o, ch∆°i; gi·∫£m ho·∫∑c tƒÉng b·∫•t th∆∞·ªùng ƒë·ªÅu c·∫ßn l∆∞u √Ω.
                  </td>
                  <td class="py-2 px-2">
                    <input type="range" min="1" max="5" value="3" data-key="activity" class="score-slider w-full" />
                    <div class="text-[11px] mt-1 text-amber-200" data-label-for="activity">Trung b√¨nh</div>
                  </td>
                  <td class="py-2 px-2">
                    <input type="text" data-note-for="activity" class="w-full rounded-md bg-black/60 border border-white/15 px-2 py-1 text-[11px]" placeholder="VD: ƒêi l·∫°i nhi·ªÅu quanh r√¨a chu·ªìng" />
                  </td>
                </tr>
                <tr class="bg-white/5 hover:bg-white/10 transition">
                  <td class="py-2 px-2 font-medium text-slate-100">T∆∞∆°ng t√°c x√£ h·ªôi</td>
                  <td class="py-2 px-2 text-slate-200">
                    ƒê·ªëi v·ªõi c√°c c√° th·ªÉ nu√¥i chung: ch∆°i ƒë√πa, li·∫øm l√¥ng, ho·∫∑c hung hƒÉng, c√¥ l·∫≠p.
                  </td>
                  <td class="py-2 px-2">
                    <input type="range" min="1" max="5" value="3" data-key="social" class="score-slider w-full" />
                    <div class="text-[11px] mt-1 text-amber-200" data-label-for="social">Trung b√¨nh</div>
                  </td>
                  <td class="py-2 px-2">
                    <input type="text" data-note-for="social" class="w-full rounded-md bg-black/60 border border-white/15 px-2 py-1 text-[11px]" placeholder="VD: N·∫±m g·∫ßn con c√°i, kh√¥ng xung ƒë·ªôt" />
                  </td>
                </tr>
                <tr class="bg-white/5 hover:bg-white/10 transition">
                  <td class="py-2 px-2 font-medium text-slate-100">H√†nh vi b·∫•t th∆∞·ªùng</td>
                  <td class="py-2 px-2 text-slate-200">
                    B∆∞·ªõc l·∫∑p l·∫°i, li·∫øm/l√†m r·ª•ng l√¥ng, c·∫Øn song s·∫Øt, quay v√≤ng‚Ä¶ (ƒëi·ªÉm cao = √≠t/kh√¥ng xu·∫•t hi·ªán).</n                  </td>
                  <td class="py-2 px-2">
                    <input type="range" min="1" max="5" value="4" data-key="stereotypy" class="score-slider w-full" />
                    <div class="text-[11px] mt-1 text-amber-200" data-label-for="stereotypy">T·ªët</div>
                  </td>
                  <td class="py-2 px-2">
                    <input type="text" data-note-for="stereotypy" class="w-full rounded-md bg-black/60 border border-white/15 px-2 py-1 text-[11px]" placeholder="VD: Kh√¥ng th·∫•y b∆∞·ªõc l·∫∑p l·∫°i" />
                  </td>
                </tr>
                <tr class="bg-white/5 hover:bg-white/10 transition">
                  <td class="py-2 px-2 font-medium text-slate-100">Ph·∫£n ·ª©ng v·ªõi kh√°ch & ng∆∞·ªùi chƒÉm s√≥c</td>
                  <td class="py-2 px-2 text-slate-200">
                    M·ª©c ƒë·ªô c·∫£nh gi√°c, s·ª£ h√£i ho·∫∑c hung hƒÉng khi c√≥ ng∆∞·ªùi t·ªõi g·∫ßn, √¢m thanh l·ªõn.
                  </td>
                  <td class="py-2 px-2">
                    <input type="range" min="1" max="5" value="3" data-key="humanReaction" class="score-slider w-full" />
                    <div class="text-[11px] mt-1 text-amber-200" data-label-for="humanReaction">Trung b√¨nh</div>
                  </td>
                  <td class="py-2 px-2">
                    <input type="text" data-note-for="humanReaction" class="w-full rounded-md bg-black/60 border border-white/15 px-2 py-1 text-[11px]" placeholder="VD: ƒê·ª©ng quan s√°t, kh√¥ng g·∫ßm g·ª´" />
                  </td>
                </tr>
                <tr class="bg-white/5 hover:bg-white/10 transition">
                  <td class="py-2 px-2 font-medium text-slate-100">S·ª≠ d·ª•ng ƒë·ªì ch∆°i/enrichment</td>
                  <td class="py-2 px-2 text-slate-200">
                    M·ª©c ƒë·ªô t∆∞∆°ng t√°c v·ªõi ƒë·ªì ch∆°i, m·ªìi treo, kh√∫c g·ªó‚Ä¶; gi·∫£m ch∆°i c√≥ th·ªÉ g·ª£i √Ω bu·ªìn ch√°n ho·∫∑c m·ªát.
                  </td>
                  <td class="py-2 px-2">
                    <input type="range" min="1" max="5" value="3" data-key="enrichment" class="score-slider w-full" />
                    <div class="text-[11px] mt-1 text-amber-200" data-label-for="enrichment">Trung b√¨nh</div>
                  </td>
                  <td class="py-2 px-2">
                    <input type="text" data-note-for="enrichment" class="w-full rounded-md bg-black/60 border border-white/15 px-2 py-1 text-[11px]" placeholder="VD: Ch∆°i v·ªõi b√≥ng treo kho·∫£ng 5 ph√∫t" />
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
          <div class="mt-4 flex flex-col md:flex-row md:items-center md:justify-between gap-3 text-xs md:text-sm">
            <div class="flex items-center gap-3">
              <div>
                <p class="text-slate-300">ƒêi·ªÉm h√†nh vi trung b√¨nh</p>
                <p id="avgScore" class="text-2xl font-bold text-amber-300">3.2</p>
              </div>
              <div>
                <p class="text-slate-300">M·ª©c c·∫£nh b√°o h√†nh vi</p>
                <div id="riskBadge" class="inline-flex items-center gap-2 px-3 py-1.5 rounded-full text-xs font-semibold bg-emerald-500/15 text-emerald-200 border border-emerald-400/60">
                  <span class="h-2.5 w-2.5 rounded-full bg-emerald-400 animate-pulse"></span>
                  B√¨nh th∆∞·ªùng
                </div>
              </div>
            </div>
            <div class="flex flex-wrap gap-2 justify-end">
              <button id="exportJsonBtn" class="px-3 py-1.5 rounded-full border border-amber-400/70 text-amber-100 text-xs hover:bg-amber-500/10 active:scale-95 transition">
                Xu·∫•t d·ªØ li·ªáu ra JSON
              </button>
              <button id="copyJsonBtn" class="px-3 py-1.5 rounded-full border border-sky-400/70 text-sky-100 text-xs hover:bg-sky-500/10 active:scale-95 transition hidden">
                Sao ch√©p JSON
              </button>
            </div>
          </div>
        </div>

        <!-- H√†nh vi theo th·ªùi ƒëi·ªÉm trong ng√†y -->
        <div class="bg-black/60 border border-white/10 rounded-2xl p-4 md:p-5 shadow-xl shadow-black/40">
          <div class="flex items-center justify-between mb-4">
            <h2 class="text-lg md:text-xl font-semibold flex items-center gap-2">
              <span class="h-6 w-1.5 rounded-full bg-amber-500"></span>
              M·∫´u h√†nh vi theo th·ªùi ƒëi·ªÉm trong ng√†y
            </h2>
            <p class="text-[11px] md:text-xs text-slate-300">ƒê√°nh d·∫•u ho·∫°t ƒë·ªông tr·ªôi trong t·ª´ng kho·∫£ng th·ªùi gian.</p>
          </div>
          <div class="grid md:grid-cols-4 gap-3 text-xs md:text-sm">
            <div class="bg-white/5 rounded-xl p-3 border border-white/10">
              <p class="font-semibold text-slate-100 mb-1">S√°ng (06:00‚Äì10:00)</p>
              <select id="morningBehavior" class="w-full rounded-md bg-black/60 border border-white/20 px-2 py-1.5 text-[11px]">
                <option value="">Ch·ªçn h√†nh vi tr·ªôi</option>
                <option value="Ng·ªß/n·∫±m y√™n">Ng·ªß/n·∫±m y√™n</option>
                <option value="ƒêi l·∫°i, tu·∫ßn tra chu·ªìng">ƒêi l·∫°i, tu·∫ßn tra chu·ªìng</option>
                <option value="ƒÇn u·ªëng">ƒÇn u·ªëng</option>
                <option value="Ch∆°i ƒë√πa, t∆∞∆°ng t√°c x√£ h·ªôi">Ch∆°i ƒë√πa, t∆∞∆°ng t√°c x√£ h·ªôi</option>
                <option value="H√†nh vi l·∫∑p l·∫°i">H√†nh vi l·∫∑p l·∫°i (b∆∞·ªõc t·ªõi lui‚Ä¶)</option>
              </select>
            </div>
            <div class="bg-white/5 rounded-xl p-3 border border-white/10">
              <p class="font-semibold text-slate-100 mb-1">Tr∆∞a (10:00‚Äì14:00)</p>
              <select id="noonBehavior" class="w-full rounded-md bg-black/60 border border-white/20 px-2 py-1.5 text-[11px]">
                <option value="">Ch·ªçn h√†nh vi tr·ªôi</option>
                <option value="Ng·ªß/n·∫±m y√™n">Ng·ªß/n·∫±m y√™n</option>
                <option value="ƒêi l·∫°i, tu·∫ßn tra chu·ªìng">ƒêi l·∫°i, tu·∫ßn tra chu·ªìng</option>
                <option value="ƒÇn u·ªëng">ƒÇn u·ªëng</option>
                <option value="Ch∆°i ƒë√πa, t∆∞∆°ng t√°c x√£ h·ªôi">Ch∆°i ƒë√πa, t∆∞∆°ng t√°c x√£ h·ªôi</option>
                <option value="H√†nh vi l·∫∑p l·∫°i">H√†nh vi l·∫∑p l·∫°i (b∆∞·ªõc t·ªõi lui‚Ä¶)</option>
              </select>
            </div>
            <div class="bg-white/5 rounded-xl p-3 border border-white/10">
              <p class="font-semibold text-slate-100 mb-1">Chi·ªÅu (14:00‚Äì18:00)</p>
              <select id="afternoonBehavior" class="w-full rounded-md bg-black/60 border border-white/20 px-2 py-1.5 text-[11px]">
                <option value="">Ch·ªçn h√†nh vi tr·ªôi</option>
                <option value="Ng·ªß/n·∫±m y√™n">Ng·ªß/n·∫±m y√™n</option>
                <option value="ƒêi l·∫°i, tu·∫ßn tra chu·ªìng">ƒêi l·∫°i, tu·∫ßn tra chu·ªìng</option>
                <option value="ƒÇn u·ªëng">ƒÇn u·ªëng</option>
                <option value="Ch∆°i ƒë√πa, t∆∞∆°ng t√°c x√£ h·ªôi">Ch∆°i ƒë√πa, t∆∞∆°ng t√°c x√£ h·ªôi</option>
                <option value="H√†nh vi l·∫∑p l·∫°i">H√†nh vi l·∫∑p l·∫°i (b∆∞·ªõc t·ªõi lui‚Ä¶)</option>
              </select>
            </div>
            <div class="bg-white/5 rounded-xl p-3 border border-white/10">
              <p class="font-semibold text-slate-100 mb-1">ƒê√™m (18:00‚Äì06:00)</p>
              <select id="nightBehavior" class="w-full rounded-md bg-black/60 border border-white/20 px-2 py-1.5 text-[11px]">
                <option value="">Ch·ªçn h√†nh vi tr·ªôi</option>
                <option value="Ng·ªß/n·∫±m y√™n">Ng·ªß/n·∫±m y√™n</option>
                <option value="ƒêi l·∫°i, tu·∫ßn tra chu·ªìng">ƒêi l·∫°i, tu·∫ßn tra chu·ªìng</option>
                <option value="SƒÉn m·ªìi gi·∫£, ch∆°i"">SƒÉn m·ªìi gi·∫£, ch∆°i</option>
                <option value="G·∫ßm g·ª´, ph√°t √¢m">G·∫ßm g·ª´, ph√°t √¢m</option>
                <option value="H√†nh vi l·∫∑p l·∫°i">H√†nh vi l·∫∑p l·∫°i (b∆∞·ªõc t·ªõi lui‚Ä¶)</option>
              </select>
            </div>
          </div>
          <p id="patternHint" class="mt-3 text-[11px] md:text-xs text-slate-200 italic">
            G·ª£i √Ω s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y d·ª±a tr√™n m·∫´u h√†nh vi ng√†y ‚Äì ƒë√™m.
          </p>
        </div>
      </section>

      <!-- C·ªôt ph·∫£i: Ghi ch√∫ & H∆∞·ªõng d·∫´n -->
      <section class="space-y-5">
        <!-- Ghi ch√∫ quan s√°t nhanh -->
        <div class="bg-black/65 border border-white/10 rounded-2xl p-4 md:p-5 shadow-xl shadow-black/40 flex flex-col h-full">
          <div class="flex items-center justify-between mb-3">
            <h2 class="text-lg font-semibold flex items-center gap-2">
              <span class="h-6 w-1.5 rounded-full bg-amber-500"></span>
              Ghi ch√∫ quan s√°t chi ti·∫øt
            </h2>
          </div>

          <label class="block text-xs md:text-sm text-slate-200 mb-1">M√¥ t·∫£ h√†nh vi v·ª´a quan s√°t</label>
          <textarea id="noteText" rows="4" class="w-full rounded-xl bg-black/60 border border-white/15 px-3 py-2 text-xs md:text-sm resize-none focus:outline-none focus:ring-1 focus:ring-amber-400/80" placeholder="VD: 09:15 ‚Äì S∆∞ t·ª≠ ƒë·ª±c n·∫±m ·ªü g√≥c chu·ªìng, th·ªânh tho·∫£ng li·∫øm l√¥ng, ph·∫£n ·ª©ng nh·∫π khi kh√°ch ƒëi ngang."></textarea>

          <div class="mt-2 grid grid-cols-2 gap-2 text-[11px] md:text-xs">
            <div>
              <label class="block text-slate-200 mb-1">M·ª©c ƒë·ªô t√≠ch c·ª±c</label>
              <select id="noteValence" class="w-full rounded-lg bg-black/60 border border-white/20 px-2 py-1.5">
                <option value="Trung t√≠nh">Trung t√≠nh</option>
                <option value="T√≠ch c·ª±c">T√≠ch c·ª±c</option>
                <option value="Ti√™u c·ª±c">Ti√™u c·ª±c</option>
              </select>
            </div>
            <div>
              <label class="block text-slate-200 mb-1">Nh√≥m h√†nh vi</label>
              <select id="noteCategory" class="w-full rounded-lg bg-black/60 border border-white/20 px-2 py-1.5">
                <option value="Chung">Chung</option>
                <option value="ƒÇn u·ªëng">ƒÇn u·ªëng</option>
                <option value="X√£ h·ªôi">X√£ h·ªôi</option>
                <option value="H√†nh vi b·∫•t th∆∞·ªùng">H√†nh vi b·∫•t th∆∞·ªùng</option>
                <option value="S·ª©c kh·ªèe">S·ª©c kh·ªèe</option>
              </select>
            </div>
          </div>

          <button id="saveNoteBtn" class="mt-3 inline-flex items-center justify-center gap-2 px-3 py-1.5 rounded-full bg-amber-500/90 text-black text-xs font-semibold hover:bg-amber-400 active:scale-95 transition">
            L∆∞u ghi ch√∫
          </button>

          <div class="mt-4 border-t border-white/10 pt-3 flex-1 flex flex-col min-h-[120px]">
            <div class="flex items-center justify-between mb-2">
              <p class="text-xs md:text-sm font-semibold text-slate-100">L·ªãch s·ª≠ ghi ch√∫ h√¥m nay</p>
              <button id="clearNotesBtn" class="text-[10px] px-2 py-0.5 rounded-full border border-slate-400/60 text-slate-200 hover:bg-slate-500/10 active:scale-95 transition">
                Xo√° ghi ch√∫
              </button>
            </div>
            <div id="notesList" class="thin-scrollbar space-y-2 max-h-60 overflow-y-auto text-[11px] md:text-xs text-slate-100">
              <p class="text-slate-300 italic">Ch∆∞a c√≥ ghi ch√∫. H√£y b·∫Øt ƒë·∫ßu b·∫±ng vi·ªác l∆∞u quan s√°t ƒë·∫ßu ti√™n.</p>
            </div>
          </div>
        </div>

        <!-- H∆∞·ªõng d·∫´n di·ªÖn gi·∫£i nhanh -->
        <div class="bg-black/65 border border-white/10 rounded-2xl p-4 md:p-4 shadow-xl shadow-black/40 text-[11px] md:text-xs space-y-2">
          <h2 class="text-sm md:text-base font-semibold mb-1">G·ª£i √Ω di·ªÖn gi·∫£i nhanh (g√≥c chuy√™n gia)</h2>
          <ul class="list-disc list-inside space-y-1 text-slate-200">
            <li><span class="font-semibold text-amber-200">ƒêi·ªÉm trung b√¨nh &lt; 2,5</span>: C·∫ßn xem l·∫°i ch·∫ø ƒë·ªô nu√¥i, enrichment v√† ki·ªÉm tra th√∫ y.</li>
            <li><span class="font-semibold text-amber-200">H√†nh vi l·∫∑p l·∫°i xu·∫•t hi·ªán &gt; 15 ph√∫t/li√™n t·ª•c</span>: Ghi ch√∫ chi ti·∫øt, trao ƒë·ªïi v·ªõi b√°c sƒ© th√∫ y v√† chuy√™n gia h√†nh vi.</li>
            <li><span class="font-semibold text-amber-200">Gi·∫£m ƒÉn ƒë·ªôt ng·ªôt ‚â• 2 b·ªØa</span>: Xem l√† t√≠n hi·ªáu c·∫£nh b√°o s·ªõm v·ªÅ b·ªánh ho·∫∑c stress.</li>
            <li><span class="font-semibold text-amber-200">√çt t∆∞∆°ng t√°c v·ªõi m√¥i tr∆∞·ªùng</span> (ƒëi·ªÉm enrichment ‚â§ 2): TƒÉng c∆∞·ªùng ƒë·ªì ch∆°i, m·ªìi treo, m√πi h∆∞∆°ng m·ªõi.</li>
            <li><span class="font-semibold text-amber-200">Ho·∫°t ƒë·ªông ƒë·∫£o l·ªôn ng√†y ‚Äì ƒë√™m</span>: C√¢n nh·∫Øc ƒëi·ªÅu ch·ªânh l·ªãch cho ƒÉn, √°nh s√°ng, ti·∫øng ·ªìn khu v·ª±c.</li>
          </ul>
          <p class="mt-2 text-slate-300">
            L∆∞u √Ω: c√°c ch·ªâ ti√™u tr√™n l√† g·ª£i √Ω chung. C·∫ßn k·∫øt h·ª£p v·ªõi ti·ªÅn s·ª≠ c√° th·ªÉ, ƒëi·ªÅu ki·ªán chu·ªìng tr·∫°i v√† trao ƒë·ªïi ƒë·ªãnh k·ª≥
            gi·ªØa ng∆∞·ªùi chƒÉm s√≥c ‚Äì b√°c sƒ© th√∫ y ‚Äì chuy√™n gia h√†nh vi ƒë·ªÉ ƒë∆∞a ra quy·∫øt ƒë·ªãnh.
          </p>
        </div>
      </section>
    </main>
  </div>

  <script>
    // C·∫≠p nh·∫≠t ng√†y gi·ªù hi·ªán t·∫°i
    function updateDateTime() {
      const now = new Date();
      const dateEl = document.getElementById('currentDate');
      const timeEl = document.getElementById('currentTime');
      if (!dateEl || !timeEl) return;
      const d = String(now.getDate()).padStart(2, '0');
      const m = String(now.getMonth() + 1).padStart(2, '0');
      const y = now.getFullYear();
      const hh = String(now.getHours()).padStart(2, '0');
      const mm = String(now.getMinutes()).padStart(2, '0');
      dateEl.textContent = `Ng√†y: ${d}/${m}/${y}`;
      timeEl.textContent = `Gi·ªù: ${hh}:${mm}`;
    }
    updateDateTime();
    setInterval(updateDateTime, 60 * 1000);

    // B·∫£n ƒë·ªì nh√£n cho ƒëi·ªÉm
    function scoreLabel(score) {
      score = Number(score);
      if (score <= 1) return 'R·∫•t ƒë√°ng lo';
      if (score === 2) return 'D∆∞·ªõi chu·∫©n';
      if (score === 3) return 'Trung b√¨nh';
      if (score === 4) return 'T·ªët';
      return 'R·∫•t t·ªët';
    }

    // C·∫≠p nh·∫≠t label v√† ƒëi·ªÉm trung b√¨nh
    const sliders = document.querySelectorAll('.score-slider');
    const avgScoreEl = document.getElementById('avgScore');
    const riskBadge = document.getElementById('riskBadge');

    function updateScores() {
      let sum = 0;
      let count = 0;
      sliders.forEach(sl => {
        const key = sl.dataset.key;
        const val = Number(sl.value || 0);
        sum += val;
        count++;
        const labelEl = document.querySelector(`[data-label-for="${key}"]`);
        if (labelEl) labelEl.textContent = scoreLabel(val);
      });
      if (!count) return;
      const avg = (sum / count).toFixed(1);
      if (avgScoreEl) avgScoreEl.textContent = avg;
      // ƒê√°nh gi√° r·ªßi ro
      const a = Number(avg);
      if (riskBadge) {
        let text = 'B√¨nh th∆∞·ªùng';
        let cls = 'inline-flex items-center gap-2 px-3 py-1.5 rounded-full text-xs font-semibold border ';
        if (a < 2.5) {
          text = 'Nguy c∆° cao';
          cls += 'bg-red-500/10 text-red-200 border-red-400/70';
        } else if (a < 3.5) {
          text = 'C·∫ßn theo d√µi';
          cls += 'bg-amber-500/10 text-amber-100 border-amber-400/70';
        } else {
          cls += 'bg-emerald-500/15 text-emerald-200 border-emerald-400/60';
        }
        riskBadge.className = cls;
        riskBadge.innerHTML = `<span class="h-2.5 w-2.5 rounded-full bg-current animate-pulse"></span>${text}`;
      }
      saveToStorage();
    }

    sliders.forEach(sl => {
      sl.addEventListener('input', updateScores);
    });
    updateScores();

    // G·ª£i √Ω m·∫´u h√†nh vi ng√†y ‚Äì ƒë√™m
    const morningSelect = document.getElementById('morningBehavior');
    const noonSelect = document.getElementById('noonBehavior');
    const afternoonSelect = document.getElementById('afternoonBehavior');
    const nightSelect = document.getElementById('nightBehavior');
    const patternHint = document.getElementById('patternHint');

    function updatePatternHint() {
      if (!patternHint) return;
      const m = morningSelect.value;
      const n = noonSelect.value;
      const a = afternoonSelect.value;
      const night = nightSelect.value;

      let msg = 'G·ª£i √Ω s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y d·ª±a tr√™n m·∫´u h√†nh vi ng√†y ‚Äì ƒë√™m.';

      const mostlySleepingDay = [m, n, a].filter(v => v === 'Ng·ªß/n·∫±m y√™n').length >= 2;
      const nightActive = night === 'SƒÉn m·ªìi gi·∫£, ch∆°i' || night === 'G·∫ßm g·ª´, ph√°t √¢m';
      const repetitiveAny = [m, n, a, night].some(v => v.includes('H√†nh vi l·∫∑p l·∫°i'));

      if (mostlySleepingDay && nightActive) {
        msg = 'M·∫´u g·∫ßn v·ªõi nh·ªãp sinh h·ªçc t·ª± nhi√™n (ng·ªß ng√†y, ho·∫°t ƒë·ªông ƒë√™m). V·∫´n c·∫ßn ƒë·∫£m b·∫£o m√¥i tr∆∞·ªùng ƒë√™m kh√¥ng qu√° ·ªìn.';
      }
      if (mostlySleepingDay && !nightActive) {
        msg = 'S∆∞ t·ª≠ kh√° √≠t ho·∫°t ƒë·ªông c·∫£ ng√†y l·∫´n ƒë√™m. C·∫ßn xem x√©t tƒÉng c∆∞·ªùng enrichment v√† ki·ªÉm tra s·ª©c kh·ªèe to√†n di·ªán.';
      }
      if (!mostlySleepingDay && nightActive) {
        msg = 'Ho·∫°t ƒë·ªông cao c·∫£ ban ng√†y v√† ban ƒë√™m. Theo d√µi th√™m xem c√≥ d·∫•u hi·ªáu lo l·∫Øng, thi·∫øu ch·ªó ngh·ªâ hay kh√¥ng.';
      }
      if (repetitiveAny) {
        msg += ' L∆∞u √Ω: C√≥ xu·∫•t hi·ªán h√†nh vi l·∫∑p l·∫°i, c·∫ßn ghi ch√∫ chi ti·∫øt th·ªùi l∆∞·ª£ng v√† ho√†n c·∫£nh.';
      }

      patternHint.textContent = msg;
      saveToStorage();
    }

    [morningSelect, noonSelect, afternoonSelect, nightSelect].forEach(sel => {
      if (sel) sel.addEventListener('change', updatePatternHint);
    });

    // Ghi ch√∫ quan s√°t v·ªõi localStorage
    const noteText = document.getElementById('noteText');
    const noteValence = document.getElementById('noteValence');
    const noteCategory = document.getElementById('noteCategory');
    const saveNoteBtn = document.getElementById('saveNoteBtn');
    const notesList = document.getElementById('notesList');
    const clearNotesBtn = document.getElementById('clearNotesBtn');

    function getStorageKey() {
      const today = new Date();
      const d = String(today.getDate()).padStart(2, '0');
      const m = String(today.getMonth() + 1).padStart(2, '0');
      const y = today.getFullYear();
      return `lion-behavior-${y}-${m}-${d}`;
    }

    function loadNotes() {
      const key = getStorageKey();
      let data;
      try {
        data = JSON.parse(localStorage.getItem(key) || '{}');
      } catch (e) {
        data = {};
      }
      return data;
    }

    function renderNotes() {
      if (!notesList) return;
      const data = loadNotes();
      const notes = data.notes || [];
      notesList.innerHTML = '';
      if (!notes.length) {
        const p = document.createElement('p');
        p.className = 'text-slate-300 italic';
        p.textContent = 'Ch∆∞a c√≥ ghi ch√∫. H√£y b·∫Øt ƒë·∫ßu b·∫±ng vi·ªác l∆∞u quan s√°t ƒë·∫ßu ti√™n.';
        notesList.appendChild(p);
        return;
      }
      notes.slice().reverse().forEach(note => {
        const item = document.createElement('div');
        const color = note.valence === 'T√≠ch c·ª±c' ? 'text-emerald-300' : note.valence === 'Ti√™u c·ª±c' ? 'text-red-300' : 'text-slate-200';
        item.className = 'border border-white/10 rounded-lg px-2 py-1.5 bg-black/50';
        item.innerHTML = `
          <div class="flex justify-between items-center mb-1">
            <span class="text-[10px] text-slate-300">${note.time} ‚Ä¢ ${note.category}</span>
            <span class="text-[10px] px-1.5 py-0.5 rounded-full border border-white/20 ${color}">${note.valence}</span>
          </div>
          <p class="text-[11px] text-slate-100 whitespace-pre-line">${note.text}</p>
        `;
        notesList.appendChild(item);
      });
    }

    function saveNote() {
      const text = (noteText.value || '').trim();
      if (!text) {
        alert('Vui l√≤ng ghi n·ªôi dung quan s√°t.');
        return;
      }
      const valence = noteValence.value || 'Trung t√≠nh';
      const category = noteCategory.value || 'Chung';
      const now = new Date();
      const hh = String(now.getHours()).padStart(2, '0');
      const mm = String(now.getMinutes()).padStart(2, '0');
      const time = `${hh}:${mm}`;
      const key = getStorageKey();
      const data = loadNotes();
      if (!Array.isArray(data.notes)) data.notes = [];
      data.notes.push({ text, valence, category, time });
      localStorage.setItem(key, JSON.stringify(data));
      noteText.value = '';
      renderNotes();
    }

    if (saveNoteBtn) saveNoteBtn.addEventListener('click', saveNote);

    if (clearNotesBtn) {
      clearNotesBtn.addEventListener('click', () => {
        if (!confirm('Xo√° to√†n b·ªô ghi ch√∫ c·ªßa h√¥m nay?')) return;
        const key = getStorageKey();
        const data = loadNotes();
        data.notes = [];
        localStorage.setItem(key, JSON.stringify(data));
        renderNotes();
      });
    }

    // L∆∞u & t·∫£i d·ªØ li·ªáu bi·ªÉu m·∫´u ch√≠nh v√†o localStorage
    function saveToStorage() {
      const key = getStorageKey();
      const existing = loadNotes();
      // Thu th·∫≠p d·ªØ li·ªáu bi·ªÉu m·∫´u
      const lionId = document.getElementById('lionId')?.value || '';
      const lionSex = document.getElementById('lionSex')?.value || '';
      const lionAge = document.getElementById('lionAge')?.value || '';
      const enclosure = document.getElementById('enclosure')?.value || '';
      const observer = document.getElementById('observer')?.value || '';
      const timeSlot = document.getElementById('timeSlot')?.value || '';

      const scores = {};
      const notes = {};
      document.querySelectorAll('.score-slider').forEach(sl => {
        const key = sl.dataset.key;
        scores[key] = Number(sl.value || 0);
        const noteInput = document.querySelector(`[data-note-for="${key}"]`);
        if (noteInput) notes[key] = noteInput.value || '';
      });

      const pattern = {
        morning: morningSelect?.value || '',
        noon: noonSelect?.value || '',
        afternoon: afternoonSelect?.value || '',
        night: nightSelect?.value || ''
      };

      const avg = avgScoreEl ? avgScoreEl.textContent : '';

      const payload = {
        ...existing,
        form: {
          lionId,
          lionSex,
          lionAge,
          enclosure,
          observer,
          timeSlot,
          scores,
          scoreNotes: notes,
          pattern,
          avg
        }
      };

      localStorage.setItem(key, JSON.stringify(payload));
    }

    function loadFormFromStorage() {
      const key = getStorageKey();
      const data = loadNotes();
      if (!data.form) {
        renderNotes();
        return;
      }
      const f = data.form;
      if (document.getElementById('lionId')) document.getElementById('lionId').value = f.lionId || '';
      if (document.getElementById('lionSex')) document.getElementById('lionSex').value = f.lionSex || '';
      if (document.getElementById('lionAge')) document.getElementById('lionAge').value = f.lionAge || '';
      if (document.getElementById('enclosure')) document.getElementById('enclosure').value = f.enclosure || '';
      if (document.getElementById('observer')) document.getElementById('observer').value = f.observer || '';
      if (document.getElementById('timeSlot')) document.getElementById('timeSlot').value = f.timeSlot || '';

      if (f.scores) {
        document.querySelectorAll('.score-slider').forEach(sl => {
          const key = sl.dataset.key;
          if (f.scores[key] != null) sl.value = f.scores[key];
        });
      }
      if (f.scoreNotes) {
        Object.keys(f.scoreNotes).forEach(k => {
          const inp = document.querySelector(`[data-note-for="${k}"]`);
          if (inp) inp.value = f.scoreNotes[k];
        });
      }
      if (f.pattern) {
        if (morningSelect) morningSelect.value = f.pattern.morning || '';
        if (noonSelect) noonSelect.value = f.pattern.noon || '';
        if (afternoonSelect) afternoonSelect.value = f.pattern.afternoon || '';
        if (nightSelect) nightSelect.value = f.pattern.night || '';
      }
      if (f.avg && avgScoreEl) avgScoreEl.textContent = f.avg;
      renderNotes();
      updateScores();
      updatePatternHint();
    }

    window.addEventListener('load', loadFormFromStorage);

    // Xo√° to√†n b·ªô d·ªØ li·ªáu bi·ªÉu m·∫´u + ghi ch√∫ h√¥m nay
    const clearAllBtn = document.getElementById('clearAllBtn');
    if (clearAllBtn) {
      clearAllBtn.addEventListener('click', () => {
        if (!confirm('Xo√° to√†n b·ªô d·ªØ li·ªáu (bi·ªÉu m·∫´u + ghi ch√∫) c·ªßa ng√†y h√¥m nay?')) return;
        const key = getStorageKey();
        localStorage.removeItem(key);
        // Reset form
        document.querySelectorAll('input, textarea, select').forEach(el => {
          if (el.type === 'range') {
            el.value = 3;
          } else if (el.type === 'number') {
            el.value = '';
          } else if (el.tagName === 'SELECT') {
            el.value = '';
          } else if (el.tagName === 'TEXTAREA' || el.type === 'text') {
            el.value = '';
          }
        });
        updateScores();
        updatePatternHint();
        renderNotes();
      });
    }

    // Xu·∫•t d·ªØ li·ªáu ra JSON
    const exportJsonBtn = document.getElementById('exportJsonBtn');
    const copyJsonBtn = document.getElementById('copyJsonBtn');

    function collectAllData() {
      const key = getStorageKey();
      const base = loadNotes();
      const now = new Date();
      const d = String(now.getDate()).padStart(2, '0');
      const m = String(now.getMonth() + 1).padStart(2, '0');
      const y = now.getFullYear();
      const hh = String(now.getHours()).padStart(2, '0');
      const mm = String(now.getMinutes()).padStart(2, '0');
      return {
        meta: {
          date: `${y}-${m}-${d}`,
          exportedAt: `${hh}:${mm}`,
          version: 'lion-captivity-1.0'
        },
        ...base
      };
    }

    if (exportJsonBtn) {
      exportJsonBtn.addEventListener('click', () => {
        const data = collectAllData();
        const jsonStr = JSON.stringify(data, null, 2);
        const blob = new Blob([jsonStr], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'su-tu_quan-sat.json';
        a.click();
        URL.revokeObjectURL(url);
        // ƒê·ªìng th·ªùi cho ph√©p sao ch√©p nhanh
        copyJsonBtn?.classList.remove('hidden');
        copyJsonBtn.dataset.json = jsonStr;
        alert('ƒê√£ t·∫°o file JSON t·∫£i xu·ªëng. B·∫°n c≈©ng c√≥ th·ªÉ sao ch√©p n·ªôi dung b·∫±ng n√∫t "Sao ch√©p JSON".');
      });
    }

    if (copyJsonBtn) {
      copyJsonBtn.addEventListener('click', async () => {
        const jsonStr = copyJsonBtn.dataset.json || JSON.stringify(collectAllData(), null, 2);
        try {
          await navigator.clipboard.writeText(jsonStr);
          alert('ƒê√£ sao ch√©p JSON v√†o clipboard.');
        } catch (e) {
          alert('Tr√¨nh duy·ªát kh√¥ng cho ph√©p sao ch√©p t·ª± ƒë·ªông. Vui l√≤ng d√πng file ƒë√£ t·∫£i xu·ªëng.');
        }
      });
    }
  </script>
</body>
</html>
